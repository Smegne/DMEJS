
<% include('../partials/header', { title: 'Dashboard' }) %>

<div class="container-fluid" id="admind">
  <div class="row">
    <!-- Sidebar -->
    <nav class="col-md-3 col-lg-2 d-md-block sidebar collapse show" id="sidebarMenu">
      <div class="position-sticky pt-3">
        <ul class="nav flex-column">
          <li class="nav-item">
            <a class="nav-link active d-flex align-items-center px-3 py-2 rounded" href="/admin">
              <i class="bi bi-speedometer2 me-2 fs-5" aria-hidden="true"></i> Dashboard
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link d-flex align-items-center px-3 py-2 rounded" href="/admin/users">
              <i class="bi bi-people me-2 fs-5" aria-hidden="true"></i> Users
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link d-flex align-items-center px-3 py-2 rounded" href="/admin/students">
              <i class="bi bi-mortarboard me-2 fs-5" aria-hidden="true"></i> Students
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link d-flex align-items-center px-3 py-2 rounded" href="/admin/workers">
              <i class="bi bi-briefcase me-2 fs-5" aria-hidden="true"></i> Workers
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link d-flex align-items-center px-3 py-2 rounded" href="/admin/payments">
              <i class="bi bi-credit-card me-2 fs-5" aria-hidden="true"></i> Payments
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link d-flex align-items-center px-3 py-2 rounded" href="/admin/courses">
              <i class="bi bi-journal-bookmark me-2 fs-5" aria-hidden="true"></i> Courses/Services
            </a>
          </li>
        </ul>
      </div>
    </nav>

    <!-- Main Content -->
    <main class="col-md-9 col-lg-10" id="mainadmin">
      <div class="d-flex justify-content-between align-items-center pt-3 pb-2 mb-4 border-bottom">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb mb-0">
            <li class="breadcrumb-item"><a href="/admin">Home</a></li>
            <li class="breadcrumb-item active" aria-current="page">Dashboard</li>
          </ol>
        </nav>
        <div>
          <button class="btn btn-primary btn-sm shadow-sm me-2" aria-label="Export Report">
            <i class="bi bi-download me-2" aria-hidden="true"></i>Export Report
          </button>
          <button class="btn btn-outline-secondary btn-sm" id="darkModeToggle" aria-label="Toggle Dark Mode">
            <i class="bi bi-moon-stars-fill" aria-hidden="true"></i>
          </button>
          <button class="btn btn-outline-primary btn-sm d-md-none" id="sidebarToggle" aria-label="Toggle Sidebar">
            <i class="bi bi-list" aria-hidden="true"></i>
          </button>
        </div>
      </div>

      <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
          <h2 class="fw-bold mb-1">ðŸ“Š Admin Dashboard</h2>
          <p class="text-muted">Quick overview of your platform statistics and activities</p>
        </div>
        <button class="btn btn-primary d-none d-md-block" aria-label="Export Report">
          <i class="bi bi-download me-2" aria-hidden="true"></i>Export Report
        </button>
      </div>

      <!-- Stats Cards -->
      <div class="row g-4 mb-5" id="whyadmin">
        <% const cardData = [
          { icon: 'bi-people', color: 'primary', title: 'Total Users', count: total_users, growth: '+5%' },
          { icon: 'bi-mortarboard', color: 'success', title: 'Total Students', count: total_students, growth: '+12%' },
          { icon: 'bi-briefcase', color: 'warning', title: 'Total Workers', count: total_workers, growth: '+3%' },
          { icon: 'bi-journal-bookmark', color: 'danger', title: 'Total Courses', count: total_courses, growth: '+8%' }
        ] %>
        <% cardData.forEach(card => { %>
          <div class="col-sm-6 col-md-3" id="users">
            <div class="card shadow-sm h-100 border-0 rounded-4 hover-scale">
              <div class="card-body text-center" id="bodycard">
                <i class="bi <%= card.icon %> fs-1 text-<%= card.color %> mb-3" aria-hidden="true"></i>
                <h5><%= card.title %></h5>
                <h2 class="fw-bold"><%= card.count %></h2>
                <small class="text-muted"><%= card.growth %> from last week</small>
              </div>
            </div>
          </div>
        <% }) %>
      </div>

      <!-- Recent Activity + Quick Actions -->
      <div class="row g-4" id="recent">
        <!-- Recent Activity -->
        <section class="col-lg-8">
          <div class="card shadow-sm rounded-4 border-0 h-100">
            <div class="card-header d-flex justify-content-between align-items-center bg-white border-bottom">
              <div>
                <h5 class="mb-0">ðŸ“ˆ Recent Activity</h5>
                <small class="text-muted">Latest system events</small>
              </div>
              <a href="#" class="btn btn-sm btn-outline-primary">View All</a>
            </div>
            <div class="card-body p-0">
              <ul class="list-group list-group-flush">
                <li class="list-group-item d-flex align-items-center py-3">
                  <div class="bg-primary bg-opacity-10 text-primary p-2 rounded me-3">
                    <i class="bi bi-person-plus" aria-hidden="true"></i>
                  </div>
                  <div class="flex-grow-1">
                    <h6 class="mb-0">New user registration</h6>
                    <small class="text-muted">John Doe registered 2 minutes ago</small>
                  </div>
                  <span class="badge bg-primary rounded-pill">New</span>
                </li>
                <li class="list-group-item d-flex align-items-center py-3">
                  <div class="bg-success bg-opacity-10 text-success p-2 rounded me-3">
                    <i class="bi bi-mortarboard" aria-hidden="true"></i>
                  </div>
                  <div class="flex-grow-1">
                    <h6 class="mb-0">New course enrollment</h6>
                    <small class="text-muted">Jane Smith enrolled in Web Development 15 minutes ago</small>
                  </div>
                </li>
                <li class="list-group-item d-flex align-items-center py-3">
                  <div class="bg-warning bg-opacity-10 text-warning p-2 rounded me-3">
                    <i class="bi bi-cash-coin" aria-hidden="true"></i>
                  </div>
                  <div class="flex-grow-1">
                    <h6 class="mb-0">New payment received</h6>
                    <small class="text-muted">$250 payment for Course XYZ 1 hour ago</small>
                  </div>
                  <span class="badge bg-success rounded-pill">Paid</span>
                </li>
              </ul>
            </div>
          </div>
        </section>

        <!-- Quick Actions -->
        <section class="col-lg-4">
          <div class="card shadow-sm rounded-4 border-0 h-100">
            <div class="card-header bg-white border-bottom">
              <h5 class="mb-0">âš¡ Quick Actions</h5>
              <small class="text-muted">Common admin tasks</small>
            </div>
            <div class="card-body">
              <div class="d-grid gap-3">
                <button class="btn btn-outline-primary d-flex align-items-center justify-content-start py-3 rounded-4 shadow-sm" data-bs-toggle="modal" data-bs-target="#addUserModal" aria-label="Add New User">
                  <i class="bi bi-person-plus fs-4 me-3" aria-hidden="true"></i>
                  <div class="text-start">
                    <div>Add New User</div>
                    <small class="text-muted">Register new platform user</small>
                  </div>
                </button>
                <button class="btn btn-outline-success d-flex align-items-center justify-content-start py-3 rounded-4 shadow-sm" data-bs-toggle="modal" data-bs-target="#createCourseModal" aria-label="Create Course">
                  <i class="bi bi-journal-plus fs-4 me-3" aria-hidden="true"></i>
                  <div class="text-start">
                    <div>Create Course</div>
                    <small class="text-muted">Add new learning course</small>
                  </div>
                </button>
                <button class="btn btn-outline-danger d-flex align-items-center justify-content-start py-3 rounded-4 shadow-sm" data-bs-toggle="modal" data-bs-target="#settingsModal" aria-label="System Settings">
                  <i class="bi bi-gear fs-4 me-3" aria-hidden="true"></i>
                  <div class="text-start">
                    <div>System Settings</div>
                    <small class="text-muted">Configure platform settings</small>
                  </div>
                </button>
              </div>
            </div>
          </div>
        </section>
      </div>

      <!-- Modals -->
      <div class="modal fade" id="addUserModal" tabindex="-1" aria-labelledby="addUserModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content rounded-4">
            <div class="modal-header border-bottom">
              <h5 class="modal-title" id="addUserModalLabel">Add New User</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <form>
                <div class="mb-3">
                  <label for="userName" class="form-label">Full Name</label>
                  <input type="text" class="form-control rounded-3" id="userName" placeholder="Enter full name" required>
                </div>
                <div class="mb-3">
                  <label for="userEmail" class="form-label">Email</label>
                  <input type="email" class="form-control rounded-3" id="userEmail" placeholder="Enter email" required>
                </div>
                <div class="mb-3">
                  <label for="userRole" class="form-label">Role</label>
                  <select class="form-select rounded-3" id="userRole" required>
                    <option value="" disabled selected>Select role</option>
                    <option value="admin">Admin</option>
                    <option value="student">Student</option>
                    <option value="worker">Worker</option>
                  </select>
                </div>
              </form>
            </div>
            <div class="modal-footer border-top">
              <button type="button" class="btn btn-outline-secondary rounded-3" data-bs-dismiss="modal">Cancel</button>
              <button type="button" class="btn btn-primary rounded-3">Save User</button>
            </div>
          </div>
        </div>
      </div>

      <div class="modal fade" id="createCourseModal" tabindex="-1" aria-labelledby="createCourseModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content rounded-4">
            <div class="modal-header border-bottom">
              <h5 class="modal-title" id="createCourseModalLabel">Create Course</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <form>
                <div class="mb-3">
                  <label for="courseTitle" class="form-label">Course Title</label>
                  <input type="text" class="form-control rounded-3" id="courseTitle" placeholder="Enter course title" required>
                </div>
                <div class="mb-3">
                  <label for="courseDescription" class="form-label">Description</label>
                  <textarea class="form-control rounded-3" id="courseDescription" rows="4" placeholder="Enter course description" required></textarea>
                </div>
              </form>
            </div>
            <div class="modal-footer border-top">
              <button type="button" class="btn btn-outline-secondary rounded-3" data-bs-dismiss="modal">Cancel</button>
              <button type="button" class="btn btn-primary rounded-3">Create Course</button>
            </div>
          </div>
        </div>
      </div>

      <div class="modal fade" id="settingsModal" tabindex="-1" aria-labelledby="settingsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content rounded-4">
            <div class="modal-header border-bottom">
              <h5 class="modal-title" id="settingsModalLabel">System Settings</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <form>
                <div class="mb-3">
                  <label for="siteName" class="form-label">Site Name</label>
                  <input type="text" class="form-control rounded-3" id="siteName" placeholder="Enter site name">
                </div>
                <div class="mb-3">
                  <label for="maintenanceMode" class="form-label">Maintenance Mode</label>
                  <select class="form-select rounded-3" id="maintenanceMode">
                    <option value="off">Off</option>
                    <option value="on">On</option>
                  </select>
                </div>
              </form>
            </div>
            <div class="modal-footer border-top">
              <button type="button" class="btn btn-outline-secondary rounded-3" data-bs-dismiss="modal">Cancel</button>
              <button type="button" class="btn btn-primary rounded-3">Save Settings</button>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
</div>

<% include('../partials/footer') %>

<style>
  /* === CSS Variables === */
  :root {
    --sidebar-width: 280px;
    --primary-color: #010318;
    --accent-color: #ff7800;
    --white: #ffffff;
    --text-muted: #6c757d;
    --main-bg: #f8f9fa;
    --card-bg: #ffffff;
    --card-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
    --hover-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
    --dark-bg: #1a2634;
    --border-color: #e9ecef;
    --transition: all 0.3s ease;
  }

  /* === General Styles === */
  body {
    min-height: 100vh;
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    font-size: 1rem;
    color: var(--primary-color);
    background: var(--main-bg);
    transition: var(--transition);
  }

  .dark-mode {
    background: var(--primary-color);
    color: var(--white);
  }
  .dark-mode #mainadmin,
  .dark-mode .card,
  .dark-mode .card-header {
    background: var(--dark-bg);
    color: var(--white);
    border-color: #495057;
  }
  .dark-mode .text-muted {
    color: #b0b0b0 !important;
  }
  .dark-mode .btn-outline-primary {
    border-color: var(--accent-color);
    color: var(--accent-color);
  }
  .dark-mode .btn-outline-primary:hover {
    background: var(--accent-color);
    color: var(--white);
  }

  /* === Layout Structure === */
  #admind {
    display: flex;
    min-height: 100vh;
  }

  /* === Sidebar === */
  #sidebarMenu {
    width: var(--sidebar-width);
    background: var(--primary-color);
    min-height: 100vh;
    position: fixed;
    z-index: 1000;
    transition: transform var(--transition);
  }
  .sidebar .nav-link {
    color: var(--white);
    padding: 12px 20px;
    margin: 4px 10px;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 400;
    transition: var(--transition);
  }
  .sidebar .nav-link.active {
    background: var(--accent-color);
    color: var(--white);
    font-weight: 500;
    box-shadow: 0 4px 10px rgba(255, 120, 0, 0.3);
  }
  .sidebar .nav-link:hover:not(.active) {
    background: rgba(255, 255, 255, 0.1);
    color: var(--white);
    transform: translateX(5px);
  }
  .sidebar .nav-link i {
    width: 24px;
    text-align: center;
    margin-right: 10px;
    font-size: 1.25rem;
  }

  /* === Main Content === */
  #mainadmin {
    margin-left: var(--sidebar-width);
    width: calc(100% - var(--sidebar-width));
    padding: 20px;
    background: var(--main-bg);
    min-height: 100vh;
    transition: var(--transition);
  }
  .dark-mode #mainadmin {
    background: var(--primary-color);
  }
  #mainadmin h2 {
    font-size: 1.75rem;
    font-weight: 700;
  }
  #mainadmin .text-muted {
    font-size: 0.875rem;
  }
  .breadcrumb {
    background: transparent;
    font-size: 0.875rem;
    margin: 0;
  }
  .breadcrumb-item a {
    color: var(--accent-color);
    text-decoration: none;
    transition: var(--transition);
  }
  .breadcrumb-item a:hover {
    text-decoration: underline;
  }

  /* === Stats Cards === */
  #whyadmin {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: 20px;
    margin: 20px 0;
  }
  .hover-scale {
    transition: var(--transition);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    background: var(--card-bg);
  }
  .hover-scale:hover {
    transform: translateY(-5px);
    box-shadow: var(--hover-shadow);
    border-color: var(--accent-color);
  }
  #bodycard {
    padding: 20px;
    text-align: center;
    border-style: dashed;
    border-width: 20px;
    border-color: #ff7800;
     box-shadow: 0 40px 50px hsla(30, 13%, 6%, 0.302);
     border-radius: 20px;
  }
  #bodycard i {
    font-size: 2.5rem;
    margin-bottom: 15px;
    transition: var(--transition);
  }
  #bodycard:hover i {
    transform: scale(1.1);
  }
  #bodycard h5 {
    font-size: 1.25rem;
    font-weight: 500;
    margin-bottom: 10px;
  }
  #bodycard h2 {
    font-size: 1.75rem;
    font-weight: 700;
    margin-bottom: 5px;
  }
  #bodycard small {
    font-size: 0.875rem;
  }

  /* === Recent Activity & Quick Actions === */
  #recent {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 20px;
    margin-top: 20px;
  }
  .card {
    border: 1px solid var(--border-color);
    border-radius: 12px;
    background: var(--card-bg);
    transition: var(--transition);
  }
  .card-header {
    background: var(--card-bg);
    border-bottom: 1px solid var(--border-color);
    padding: 15px 20px;
  }
  .card-header h5 {
    font-size: 1.25rem;
    font-weight: 500;
  }
  .card-header small {
    font-size: 0.875rem;
  }
  .list-group-item {
    padding: 15px 20px;
    border-color: var(--border-color);
    transition: var(--transition);
  }
  .list-group-item:hover {
    background: rgba(255, 120, 0, 0.05);
  }
  .list-group-item h6 {
    font-size: 1rem;
    font-weight: 500;
  }
  .list-group-item small {
    font-size: 0.875rem;
  }
  .list-group-item .bg-primary {
    background: var(--accent-color) !important;
    color: var(--white) !important;
  }
  .list-group-item .bg-success {
    background: #28a745 !important;
    color: var(--white) !important;
  }
  .list-group-item .bg-warning {
    background: #ffc107 !important;
    color: var(--primary-color) !important;
  }

  /* === Buttons & Badges === */
  .btn-primary {
    background: var(--accent-color);
    border-color: var(--accent-color);
    font-size: 1rem;
    padding: 10px 20px;
    border-radius: 8px;
    transition: var(--transition);
  }
  .btn-primary:hover {
    background: #e06b00;
    border-color: #e06b00;
    box-shadow: 0 4px 10px rgba(255, 120, 0, 0.3);
  }
  .btn-outline-primary {
    border-color: var(--accent-color);
    color: var(--accent-color);
    font-size: 1rem;
    padding: 10px 20px;
    border-radius: 8px;
    transition: var(--transition);
  }
  .btn-outline-primary:hover {
    background: var(--accent-color);
    color: var(--white);
    box-shadow: 0 4px 10px rgba(255, 120, 0, 0.3);
  }
  .btn-outline-secondary {
    border-color: var(--text-muted);
    color: var(--text-muted);
    transition: var(--transition);
  }
  .btn-outline-secondary:hover {
    background: var(--text-muted);
    color: var(--white);
  }
  .badge.rounded-pill {
    font-size: 0.75rem;
    padding: 0.4em 0.8em;
    background: var(--accent-color);
    color: var(--white);
    border-radius: 12px;
  }

  /* === Modals === */
  .modal-content {
    border: none;
    border-radius: 12px;
    box-shadow: var(--hover-shadow);
    background: var(--card-bg);
  }
  .dark-mode .modal-content {
    background: var(--dark-bg);
    color: var(--white);
  }
  .modal-header {
    border-bottom: 1px solid var(--border-color);
    padding: 15px 20px;
  }
  .modal-footer {
    border-top: 1px solid var(--border-color);
    padding: 15px 20px;
  }
  .modal-body {
    padding: 20px;
  }
  .form-control,
  .form-select {
    border-radius: 8px;
    font-size: 1rem;
    transition: var(--transition);
  }
  .form-control:focus,
  .form-select:focus {
    border-color: var(--accent-color);
    box-shadow: 0 0 0 0.2rem rgba(255, 120, 0, 0.25);
  }
  .modal .btn {
    padding: 8px 16px;
  }

  /* === Responsive Design === */
  @media (max-width: 992px) {
    #recent {
      grid-template-columns: 1fr;
    }
  }
  @media (max-width: 768px) {
    #sidebarMenu {
      transform: translateX(-100%);
    }
    #sidebarMenu.show {
      transform: translateX(0);
    }
    #mainadmin {
      margin-left: 0;
      width: 100%;
      padding: 15px;
    }
    #whyadmin {
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    }
    #bodycard {
      padding: 15px;
    }
    #bodycard i {
      font-size: 2rem;
    }
    #bodycard h5 {
      font-size: 1.1rem;
    }
    #bodycard h2 {
      font-size: 1.5rem;
    }
    .modal-dialog {
      margin: 10px;
    }
  }
</style>

<script>
  // Dark Mode Toggle
  document.getElementById('darkModeToggle').addEventListener('click', () => {
    document.body.classList.toggle('dark-mode');
    localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
  });

  // Load Dark Mode Preference
  if (localStorage.getItem('darkMode') === 'true') {
    document.body.classList.add('dark-mode');
  }

  // Sidebar Toggle for Mobile
  document.getElementById('sidebarToggle').addEventListener('click', () => {
    document.getElementById('sidebarMenu').classList.toggle('show');
  });

  // Modal Form Submission (Placeholder)
  document.querySelectorAll('.modal .btn-primary').forEach(btn => {
    btn.addEventListener('click', () => {
      // Add backend submission logic here
      console.log('Form submitted');
      bootstrap.Modal.getInstance(btn.closest('.modal')).hide();
    });
  });
</script>